<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Lira Link - Smart Currency Converter by Anas Shameea">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#2563EB">
    <link rel="apple-touch-icon" href="icon192.png">
    <title>Lira Link | MR.Q Ecosystem</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Arabic:wght@300;400;500;700;800&family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #F3F4F6;
            --bg-card: #FFFFFF;
            --text-primary: #111827;
            --text-secondary: #4B5563; 
            --accent-color: #2563EB;
            --border-color: #D1D5DB;
            --input-bg: #F9FAFB;
        }
        .dark-mode {
            --bg-primary: #0F172A;
            --bg-card: #1E293B;
            --text-primary: #F1F5F9;
            --text-secondary: #94A3B8;
            --accent-color: #3B82F6;
            --border-color: #334155;
            --input-bg: #0F172A;
        }

        body { 
            font-family: 'Noto Sans Arabic', 'Inter', sans-serif; 
            background-color: var(--bg-primary); 
            color: var(--text-primary); 
            transition: background-color 0.3s ease, color 0.3s ease;
            -webkit-tap-highlight-color: transparent;
        }

        .glass-card {
            background-color: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 24px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
        }

        .modern-input, select {
            background-color: var(--input-bg) !important;
            border: 2px solid var(--border-color) !important;
            color: var(--text-primary) !important;
            border-radius: 16px;
            padding: 14px 18px;
            transition: all 0.2s;
            outline: none;
        }
        .modern-input:focus, select:focus {
            border-color: var(--accent-color) !important;
            box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.1);
        }

        .tab-btn {
            background: transparent;
            color: var(--text-secondary);
            border-radius: 14px;
            font-weight: 600;
            transition: all 0.2s;
        }
        .tab-active {
            background-color: var(--accent-color);
            color: #ffffff !important;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }

        .animate-enter { animation: slideUp 0.5s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        
        .live-indicator { animation: pulse-glow 2s infinite; }
        @keyframes pulse-glow { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }

        .btn-action {
            background-color: var(--bg-card);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
            transition: all 0.2s;
        }
        .btn-action:active { transform: scale(0.95); }

        .market-item {
            background-color: var(--bg-card);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
        }
    </style>
</head>
<body class="min-h-screen p-4 md:p-8 selection:bg-blue-500 selection:text-white">

    <div class="max-w-6xl mx-auto">
        <header class="flex flex-col md:flex-row justify-between items-start md:items-center gap-6 mb-10 animate-enter">
            <div>
                <h1 class="text-4xl font-extrabold tracking-tight mb-2">
                    <span style="color: var(--accent-color)">Lira Link</span>
                </h1>
                <p id="dev-tag" class="text-sm font-medium" style="color: var(--text-secondary)">
                    MR.Q Financial Ecosystem | Dev: <span class="text-blue-500 font-bold">Anas Shameea</span>
                </p>
            </div>
            
            <div class="flex items-center gap-3 bg-white dark:bg-gray-800 p-1.5 rounded-2xl shadow-md border border-gray-200 dark:border-gray-700">
                <button onclick="toggleLang()" id="langBtn" class="px-4 py-2 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 font-bold text-sm transition-colors" style="color: var(--text-primary)">English</button>
                <div class="w-px h-6 bg-gray-300 dark:bg-gray-600"></div>
                <button onclick="toggleTheme()" class="p-2 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors text-lg">ğŸŒ“</button>
            </div>
        </header>

        <nav class="flex flex-wrap gap-2 mb-8 p-1.5 rounded-2xl w-full md:w-fit glass-card animate-enter">
            <button onclick="switchTab('main')" id="tab-main" class="tab-btn tab-active flex-1 md:flex-none px-6 py-3">Ø§Ù„Ù…Ø­ÙˆÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ</button>
            <button onclick="switchTab('smart')" id="tab-smart" class="tab-btn flex-1 md:flex-none px-6 py-3">Ø§Ù„Ø¯ÙØ¹ Ø§Ù„Ø°ÙƒÙŠ</button>
            <button onclick="switchTab('market')" id="tab-market" class="tab-btn flex-1 md:flex-none px-6 py-3">Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ</button>
        </nav>

        <main id="view-main" class="animate-enter">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <div class="lg:col-span-2 glass-card p-6 md:p-8">
                    <div class="flex items-center gap-2 mb-6">
                        <div class="w-2 h-8 rounded-full bg-blue-600"></div>
                        <h2 id="title-conv" class="text-xl font-bold">ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¹Ù…Ù„Ø© (SYP)</h2>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 relative">
                        <div class="space-y-3">
                            <label id="lbl-old" class="text-sm font-bold flex justify-between">
                                <span>Ø§Ù„Ù‚ÙŠÙ…Ø© Ø¨Ø§Ù„Ù‚Ø¯ÙŠÙ…</span>
                                <span class="bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded text-xs">SYP Old</span>
                            </label>
                            <input type="number" id="oldSyp" class="modern-input" placeholder="0" oninput="handleMainInput('old')">
                            <p id="formatted-old" class="text-[10px] opacity-60 px-2 font-bold"></p>
                        </div>
                        
                        <div class="space-y-3">
                            <label id="lbl-new" class="text-sm font-bold flex justify-between text-blue-500">
                                <span>Ø§Ù„Ù‚ÙŠÙ…Ø© Ø¨Ø§Ù„Ø¬Ø¯ÙŠØ¯</span>
                                <span class="bg-blue-100 dark:bg-blue-900 px-2 py-0.5 rounded text-xs">SYP New</span>
                            </label>
                            <input type="number" id="newSyp" class="modern-input" placeholder="0" oninput="handleMainInput('new')">
                            <p id="formatted-new" class="text-[10px] opacity-60 px-2 font-bold"></p>
                        </div>
                    </div>

                    <div class="mt-8 p-6 bg-blue-50 dark:bg-blue-900/20 rounded-3xl border border-blue-100 dark:border-blue-800/50">
                        <div class="flex flex-wrap justify-between items-center gap-4 mb-4">
                            <div class="flex items-center gap-2">
                                <span class="text-2xl">ğŸ‡ºğŸ‡¸</span>
                                <span id="lbl-rate" class="font-bold">Ø³Ø¹Ø± ØµØ±Ù Ø§Ù„Ø¯ÙˆÙ„Ø§Ø± (ÙŠØ¯ÙˆÙŠ)</span>
                            </div>
                            <input type="number" id="usdRate" value="15000" class="w-32 p-2 rounded-xl border text-center font-bold text-blue-600 bg-white dark:bg-gray-800" oninput="handleMainInput('old')">
                        </div>
                        <div class="h-px bg-blue-200 dark:bg-blue-800 mb-4"></div>
                        <div class="flex justify-between items-end">
                            <div>
                                <p id="lbl-equiv" class="text-xs font-bold uppercase tracking-wider opacity-60 mb-1">Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø©</p>
                                <h2 class="text-4xl font-black text-blue-600 dark:text-blue-400" id="usdResult">0.00 $</h2>
                            </div>
                            <button id="btn-copy" onclick="copyToClipboard('usdResult')" class="btn-action px-5 py-2.5 rounded-xl font-bold text-sm">Ù†Ø³Ø® Ø§Ù„Ù…Ø¨Ù„Øº</button>
                        </div>
                    </div>
                </div>

                <div class="glass-card p-6 h-fit">
                    <h3 id="lbl-notes" class="font-bold mb-4 flex items-center gap-2 text-lg">ØªÙ‚Ø³ÙŠÙ… Ø§Ù„ÙØ¦Ø§Øª</h3>
                    <div id="notesContainer" class="space-y-2 max-h-[400px] overflow-y-auto pr-1">
                        <div class="text-center py-10 opacity-50 text-sm">Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº Ù„Ø¹Ø±Ø¶ Ø§Ù„ÙØ¦Ø§Øª</div>
                    </div>
                </div>
            </div>
        </main>

        <section id="view-smart" class="hidden animate-enter">
            <div class="max-w-2xl mx-auto glass-card p-8">
                <h3 id="title-smart" class="text-2xl font-bold mb-8 text-center">Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø¯ÙØ¹ Ø§Ù„Ø°ÙƒÙŠ</h3>
                <div class="space-y-6">
                    <div class="flex gap-4 items-end">
                        <div class="flex-1 space-y-2">
                            <label id="lbl-price" class="text-sm font-bold">Ø³Ø¹Ø± Ø§Ù„ØºØ±Ø¶ (Ø§Ù„Ù…Ø·Ù„ÙˆØ¨)</label>
                            <input type="number" id="payPrice" class="modern-input" placeholder="0" oninput="runSmartPay()">
                        </div>
                        <select id="payPriceType" class="modern-input w-32" onchange="runSmartPay()">
                            <option value="new">Ø¨Ø§Ù„Ø¬Ø¯ÙŠØ¯</option>
                            <option value="old">Ø¨Ø§Ù„Ù‚Ø¯ÙŠÙ…</option>
                        </select>
                    </div>

                    <div id="smart-suggestion" class="text-center text-sm font-bold text-blue-500">---</div>

                    <div class="flex gap-4 items-end">
                        <div class="flex-1 space-y-2">
                            <label id="lbl-paid" class="text-sm font-bold text-green-600">Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¯ÙÙˆØ¹ ÙØ¹Ù„ÙŠØ§Ù‹</label>
                            <input type="number" id="payAmount" class="modern-input" placeholder="0" oninput="runSmartPay()">
                        </div>
                        <select id="payAmountType" class="modern-input w-32" onchange="runSmartPay()">
                            <option value="new">Ø¨Ø§Ù„Ø¬Ø¯ÙŠØ¯</option>
                            <option value="old">Ø¨Ø§Ù„Ù‚Ø¯ÙŠÙ…</option>
                        </select>
                    </div>

                    <div class="grid grid-cols-2 gap-4 pt-4">
                        <div class="p-4 rounded-2xl bg-green-50 dark:bg-green-900/20 text-center">
                            <p id="res-lbl-new" class="text-xs font-bold text-green-600 mb-1">Ø§Ù„Ø¨Ø§Ù‚ÙŠ (Ø¨Ø§Ù„Ø¬Ø¯ÙŠØ¯)</p>
                            <p class="text-2xl font-black text-green-700 dark:text-green-400" id="res-change-new">0</p>
                        </div>
                        <div class="p-4 rounded-2xl bg-orange-50 dark:bg-orange-900/20 text-center">
                            <p id="res-lbl-old" class="text-xs font-bold text-orange-600 mb-1">Ø§Ù„Ø¨Ø§Ù‚ÙŠ (Ø¨Ø§Ù„Ù‚Ø¯ÙŠÙ…)</p>
                            <p class="text-2xl font-black text-orange-700 dark:text-orange-400" id="res-change-old">0</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="view-market" class="hidden animate-enter">
            <div class="glass-card p-6 md:p-8">
                <div class="flex flex-wrap justify-between items-center mb-8 gap-4">
                    <div>
                        <h3 id="title-market" class="text-2xl font-bold">Ø§Ù„Ø£Ø³ÙˆØ§Ù‚ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠØ©</h3>
                        <p class="text-sm opacity-60 mt-1">Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø°Ù‡Ø¨ØŒ Ø§Ù„ÙØ¶Ø©ØŒ ÙˆØ§Ù„Ø¹Ù…Ù„Ø§Øª Ø§Ù„Ø±Ù‚Ù…ÙŠØ©</p>
                    </div>
                    <div class="flex items-center gap-2 bg-green-50 dark:bg-green-900/20 px-3 py-1.5 rounded-full border border-green-100 dark:border-green-800">
                        <span class="w-2.5 h-2.5 rounded-full bg-green-500 live-indicator"></span>
                        <span class="text-xs font-bold text-green-700 dark:text-green-400">ØªØ­Ø¯ÙŠØ« Ù…Ø¨Ø§Ø´Ø± (5s)</span>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div class="space-y-6">
                        <h4 class="font-bold flex items-center gap-2">ğŸ† Ø§Ù„Ù…Ø¹Ø§Ø¯Ù† ÙˆØ§Ù„ÙÙˆØ±ÙƒØ³</h4>
                        <div id="commodities-list" class="space-y-3">
                            <div class="p-4 text-center opacity-50">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
                        </div>
                    </div>
                    <div class="space-y-6">
                        <h4 class="font-bold flex items-center gap-2">â‚¿ Ø§Ù„Ø¹Ù…Ù„Ø§Øª Ø§Ù„Ø±Ù‚Ù…ÙŠØ©</h4>
                        <div id="crypto-list" class="space-y-3">
                            <div class="p-4 text-center opacity-50">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <footer class="mt-20 text-center opacity-40 space-y-2 pb-8 text-xs font-bold">
            <p>MR.Q ECOSYSTEM Â© 2026 | LIRA LINK PRO V3.0</p>
        </footer>
    </div>

    <script>
        let currentLang = localStorage.getItem('lang') || 'ar';
        const i18n = {
            ar: {
                langBtn: "English",
                tabMain: "Ø§Ù„Ù…Ø­ÙˆÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ",
                tabSmart: "Ø§Ù„Ø¯ÙØ¹ Ø§Ù„Ø°ÙƒÙŠ",
                tabMarket: "Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ",
                titleConv: "ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¹Ù…Ù„Ø© (SYP)",
                lblOld: "Ø§Ù„Ù‚ÙŠÙ…Ø© Ø¨Ø§Ù„Ù‚Ø¯ÙŠÙ…",
                lblNew: "Ø§Ù„Ù‚ÙŠÙ…Ø© Ø¨Ø§Ù„Ø¬Ø¯ÙŠØ¯",
                lblRate: "Ø³Ø¹Ø± ØµØ±Ù Ø§Ù„Ø¯ÙˆÙ„Ø§Ø± (ÙŠØ¯ÙˆÙŠ)",
                lblEquiv: "Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø©",
                btnCopy: "Ù†Ø³Ø® Ø§Ù„Ù…Ø¨Ù„Øº",
                lblNotes: "ØªÙ‚Ø³ÙŠÙ… Ø§Ù„ÙØ¦Ø§Øª",
                titleSmart: "Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø¯ÙØ¹ Ø§Ù„Ø°ÙƒÙŠ",
                lblPrice: "Ø³Ø¹Ø± Ø§Ù„ØºØ±Ø¶ (Ø§Ù„Ù…Ø·Ù„ÙˆØ¨)",
                lblPaid: "Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¯ÙÙˆØ¹ ÙØ¹Ù„ÙŠØ§Ù‹",
                resNew: "Ø§Ù„Ø¨Ø§Ù‚ÙŠ (Ø¨Ø§Ù„Ø¬Ø¯ÙŠØ¯)",
                resOld: "Ø§Ù„Ø¨Ø§Ù‚ÙŠ (Ø¨Ø§Ù„Ù‚Ø¯ÙŠÙ…)",
                titleMarket: "Ø§Ù„Ø£Ø³ÙˆØ§Ù‚ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠØ©"
            },
            en: {
                langBtn: "Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©",
                tabMain: "Main Converter",
                tabSmart: "Smart Pay",
                tabMarket: "Global Market",
                titleConv: "Converter (SYP)",
                lblOld: "Old Syp Value",
                lblNew: "New Syp Value",
                lblRate: "USD Rate (Manual)",
                lblEquiv: "Equivalent Value",
                btnCopy: "Copy Amount",
                lblNotes: "Notes Breakdown",
                titleSmart: "Smart Pay Calc",
                lblPrice: "Required Price",
                lblPaid: "Actually Paid",
                resNew: "Change (New)",
                resOld: "Change (Old)",
                titleMarket: "Global Markets"
            }
        };

        function toggleTheme() {
            document.body.classList.toggle('dark-mode');
            localStorage.setItem('theme', document.body.classList.contains('dark-mode') ? 'dark' : 'light');
        }

        function toggleLang() {
            currentLang = currentLang === 'ar' ? 'en' : 'ar';
            localStorage.setItem('lang', currentLang);
            applyLang();
        }

        function applyLang() {
            const t = i18n[currentLang];
            document.documentElement.dir = currentLang === 'ar' ? 'rtl' : 'ltr';
            document.getElementById('langBtn').innerText = t.langBtn;
            document.getElementById('tab-main').innerText = t.tabMain;
            document.getElementById('tab-smart').innerText = t.tabSmart;
            document.getElementById('tab-market').innerText = t.tabMarket;
            document.getElementById('title-conv').innerText = t.titleConv;
            document.getElementById('lbl-old').querySelector('span').innerText = t.lblOld;
            document.getElementById('lbl-new').querySelector('span').innerText = t.lblNew;
            document.getElementById('lbl-rate').innerText = t.lblRate;
            document.getElementById('lbl-equiv').innerText = t.lblEquiv;
            document.getElementById('btn-copy').innerText = t.btnCopy;
            document.getElementById('lbl-notes').innerText = t.lblNotes;
            document.getElementById('title-smart').innerText = t.titleSmart;
            document.getElementById('lbl-price').innerText = t.lblPrice;
            document.getElementById('lbl-paid').innerText = t.lblPaid;
            document.getElementById('res-lbl-new').innerText = t.resNew;
            document.getElementById('res-lbl-old').innerText = t.resOld;
            document.getElementById('title-market').innerText = t.titleMarket;
        }

        function switchTab(tabId) {
            ['main', 'smart', 'market'].forEach(t => {
                document.getElementById(`view-${t}`).classList.add('hidden');
                document.getElementById(`tab-${t}`).classList.remove('tab-active');
            });
            document.getElementById(`view-${tabId}`).classList.remove('hidden');
            document.getElementById(`tab-${tabId}`).classList.add('tab-active');
        }

        function handleMainInput(source) {
            const oldIn = document.getElementById('oldSyp');
            const newIn = document.getElementById('newSyp');
            const rate = parseFloat(document.getElementById('usdRate').value) || 15000;
            localStorage.setItem('savedRate', rate);

            if(source === 'old') {
                newIn.value = oldIn.value ? (parseFloat(oldIn.value) / 100).toFixed(2) : '';
            } else {
                oldIn.value = newIn.value ? (parseFloat(newIn.value) * 100).toFixed(0) : '';
            }
            
            document.getElementById('formatted-old').innerText = oldIn.value ? Number(oldIn.value).toLocaleString() : '';
            document.getElementById('formatted-new').innerText = newIn.value ? Number(newIn.value).toLocaleString() : '';

            const usdVal = oldIn.value ? (parseFloat(oldIn.value) / rate).toFixed(2) : "0.00";
            document.getElementById('usdResult').innerText = usdVal + " $";
            renderNotes(parseFloat(newIn.value));
        }

        function renderNotes(val) {
            const container = document.getElementById('notesContainer');
            if(!val) { container.innerHTML = '<div class="text-center py-10 opacity-50 text-sm">Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº Ù„Ø¹Ø±Ø¶ Ø§Ù„ÙØ¦Ø§Øª</div>'; return; }
            let amount = Math.floor(val);
            let html = '';
            [500, 200, 100, 50, 25, 10, 5, 1].forEach(note => {
                let count = Math.floor(amount / note);
                amount %= note;
                if(count > 0) {
                    html += `<div class="flex justify-between items-center p-3 market-item rounded-xl mb-2">
                        <span class="font-bold">${note} Ù„ÙŠØ±Ø©</span>
                        <span class="bg-blue-600 text-white px-3 py-1 rounded-lg text-xs font-bold">X ${count}</span>
                    </div>`;
                }
            });
            container.innerHTML = html;
        }

        function runSmartPay() {
            const p = parseFloat(document.getElementById('payPrice').value) || 0;
            const pt = document.getElementById('payPriceType').value;
            const a = parseFloat(document.getElementById('payAmount').value) || 0;
            const at = document.getElementById('payAmountType').value;

            const pOld = pt === 'new' ? p * 100 : p;
            const aOld = at === 'new' ? a * 100 : a;
            const diff = aOld - pOld;

            document.getElementById('res-change-old').innerText = diff.toLocaleString();
            document.getElementById('res-change-new').innerText = (diff / 100).toFixed(2);
            document.getElementById('smart-suggestion').innerText = p > 0 ? `ÙŠØ¹Ø§Ø¯Ù„ Ø¨Ø§Ù„Ù€ ${pt==='old'?'Ø¬Ø¯ÙŠØ¯':'Ù‚Ø¯ÙŠÙ…'}: ${pt==='old'?(p/100).toFixed(2):(p*100).toLocaleString()}` : '---';
        }

        async function fetchMarketData() {
            try {
                const [cryptoRes, forexRes] = await Promise.all([
                    fetch('https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&ids=bitcoin,ethereum,binancecoin,solana,ripple,pax-gold,kinesis-silver&order=market_cap_desc'),
                    fetch('https://api.frankfurter.app/latest?from=USD&to=EUR,GBP,TRY,SAR,AED')
                ]);
                const data = await cryptoRes.json();
                const forexData = await forexRes.json();

                const gold = data.find(c => c.id === 'pax-gold');
                const silver = data.find(c => c.id === 'kinesis-silver');
                let commHtml = '';
                if(gold) commHtml += createItem('Gold', 'XAU', gold.current_price, gold.price_change_percentage_24h, 'ğŸ†');
                if(silver) commHtml += createItem('Silver', 'XAG', silver.current_price, silver.price_change_percentage_24h, 'ğŸ¥ˆ');
                
                ['EUR', 'GBP', 'TRY'].forEach(k => {
                    commHtml += `<div class="flex justify-between p-3 market-item rounded-xl shadow-sm font-bold">
                        <span style="color: var(--text-primary)">USD/${k}</span>
                        <span class="font-mono text-blue-600">${forexData.rates[k].toFixed(3)}</span>
                    </div>`;
                });
                document.getElementById('commodities-list').innerHTML = commHtml;

                document.getElementById('crypto-list').innerHTML = data
                    .filter(c => !['pax-gold', 'kinesis-silver'].includes(c.id))
                    .slice(0, 5)
                    .map(c => createItem(c.name, c.symbol.toUpperCase(), c.current_price, c.price_change_percentage_24h, 'â‚¿'))
                    .join('');
            } catch(e) { console.error(e); }
        }

        function createItem(n, s, p, c, i) {
            const isUp = c >= 0;
            return `<div class="flex justify-between items-center p-3 market-item rounded-xl shadow-sm mb-2">
                <div class="flex items-center gap-2">
                    <span class="text-lg">${i}</span>
                    <div>
                        <div class="text-sm font-black" style="color: var(--text-primary)">${s}</div>
                        <div class="text-[10px] font-bold" style="color: var(--text-secondary)">${n}</div>
                    </div>
                </div>
                <div class="text-right">
                    <div class="text-sm font-black" style="color: var(--text-primary)">$${p.toLocaleString()}</div>
                    <div class="text-[10px] font-bold ${isUp?'text-green-600':'text-red-600'}">${isUp?'â–²':'â–¼'} ${Math.abs(c).toFixed(2)}%</div>
                </div>
            </div>`;
        }

        function copyToClipboard(id) {
            navigator.clipboard.writeText(document.getElementById(id).innerText);
            alert("ØªÙ… Ø§Ù„Ù†Ø³Ø®!");
        }

        window.onload = () => {
            if(localStorage.getItem('theme') === 'dark') document.body.classList.add('dark-mode');
            if(localStorage.getItem('savedRate')) document.getElementById('usdRate').value = localStorage.getItem('savedRate');
            applyLang();
            fetchMarketData();
            setInterval(fetchMarketData, 30000); 
            
            // PWA Registration Code
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('./service-worker.js')
                .then(() => console.log("Service Worker Registered"));
            }
        };
    </script>
</body>
</html>
